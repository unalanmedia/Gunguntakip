<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kurâ€™an Okuma Takibi</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2a3cff" />

<style>
body{
  margin:0;font-family:system-ui;background:#0b1020;color:#fff;padding:16px
}
button{padding:10px 14px;border-radius:10px;border:none;background:#2a3cff;color:#fff;font-weight:700}
.secondary{background:#444}
.card{background:#151b30;border-radius:14px;padding:14px;margin-bottom:12px}
.list div{margin:6px 0}
</style>
</head>

<body>

<h2>ðŸ“– Kurâ€™an Okuma Takibi</h2>
<p>BaÅŸlangÄ±Ã§: <b>21 AralÄ±k 2025</b></p>

<div class="card">
  <button id="todayBtn">BugÃ¼n okudum</button>
</div>

<div class="card">
  <b>Google Bulut</b><br><br>
  <button id="loginBtn" class="secondary">Google ile giriÅŸ</button>
  <button id="logoutBtn" class="secondary" style="display:none">Ã‡Ä±kÄ±ÅŸ</button>
  <p id="cloudStatus">Bulut: KapalÄ±</p>
</div>

<div class="card">
  <b>Okunan GÃ¼nler</b>
  <div class="list" id="list"></div>
</div>

<script>
const START="2025-12-21";
const KEY="kuran_done_days";

function today(){
  const d=new Date();
  return d.toISOString().split("T")[0];
}

function load(){
  return JSON.parse(localStorage.getItem(KEY)||"[]");
}
function save(arr){
  localStorage.setItem(KEY,JSON.stringify(arr));
}

function render(){
  const list=document.getElementById("list");
  list.innerHTML="";
  load().forEach(d=>{
    const div=document.createElement("div");
    div.textContent="âœ” "+d;
    list.appendChild(div);
  });
}

document.getElementById("todayBtn").onclick=()=>{
  const t=today();
  const arr=load();
  if(!arr.includes(t)){
    arr.push(t);
    save(arr);
    render();
  }
};

render();
</script>

<!-- ðŸ”¥ FIREBASE GOOGLE LOGIN (HAZIR) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc }
from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCNFwiIe6IvAUU_YD7ggmA3ptY2WxE6v3E",
  authDomain: "gunguntakip.firebaseapp.com",
  projectId: "gunguntakip",
  storageBucket: "gunguntakip.firebasestorage.app",
  messagingSenderId: "311865369286",
  appId: "1:311865369286:web:55766cd9949e895e176dc7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

const loginBtn=document.getElementById("loginBtn");
const logoutBtn=document.getElementById("logoutBtn");
const cloudStatus=document.getElementById("cloudStatus");

loginBtn.onclick=()=>signInWithPopup(auth,provider);
logoutBtn.onclick=()=>signOut(auth);

onAuthStateChanged(auth,async user=>{
  if(user){
    loginBtn.style.display="none";
    logoutBtn.style.display="inline-block";
    cloudStatus.textContent="Bulut: AÃ§Ä±k ("+user.email+")";

    const ref=doc(db,"users",user.uid);
    const snap=await getDoc(ref);
    if(snap.exists()){
      localStorage.setItem(KEY,JSON.stringify(snap.data().days||[]));
      render();
    }
    await setDoc(ref,{days:load()},{merge:true});
  }else{
    loginBtn.style.display="inline-block";
    logoutBtn.style.display="none";
    cloudStatus.textContent="Bulut: KapalÄ±";
  }
});
</script>

</body>
</html>
